import json
from files.filesExtractionBase import classParse


def main():
    features = ['BytesSize', 'BytesEntropy']

    with open("../config.json") as f:
        configs = json.load(f)

    csvName = configs['files_csv_name']
    feaClass = csvName[:-4]
    # 对于每一个文件，都应该完成features的填充，boolean类型
    print('Start to extract ' + feaClass + ' features for each malicious sample in train set:')
    classParse(features, configs['malicious_train_samples_path'], configs['mal_train_csv_path'] + csvName)
    print()

    print('Start to extract ' + feaClass + ' features for each benign sample in train set:')
    classParse(features, configs['benign_train_samples_path'], configs['ben_train_csv_path'] + csvName)
    print()

    print('Start to extract ' + feaClass + ' features for each malicious sample in validation set:')
    classParse(features, configs['malicious_validation_samples_path'], configs['mal_validation_csv_path'] + csvName)
    print()

    print('Start to extract ' + feaClass + ' features for each benign sample in validation set:')
    classParse(features, configs['benign_validation_samples_path'], configs['ben_validation_csv_path'] + csvName)
    print()

    print('Start to extract ' + feaClass + ' features for each test sample:')
    classParse(features, configs['test_samples_path'], configs['test_csv_path'] + csvName)
    print()


if __name__ == '__main__':
    main()
